(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["MultiSites"]=t(require("CoreHome"),require("vue")):e["MultiSites"]=t(e["CoreHome"],e["Vue"])})("undefined"!==typeof self?self:this,(function(e,t){return function(e){var t={};function r(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="plugins/MultiSites/vue/dist/",r(r.s="fae3")}({"19dc":function(t,r){t.exports=e},"8bbf":function(e,r){e.exports=t},fae3:function(e,t,r){"use strict";if(r.r(t),r.d(t,"AllWebsitesDashboard",(function(){return we})),r.d(t,"MultisitesSite",(function(){return it})),r.d(t,"DashboadStore",(function(){return lt})),r.d(t,"Dashboard",(function(){return er})),"undefined"!==typeof window){var a=window.document.currentScript,o=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(r.p=o[1])}var i=r("8bbf");const s={class:"dashboardHeader"},n={class:"card-title"},l={class:"dashboardControls"},c={class:"siteSearch"},u=["placeholder"],d=["title"],m=["href"];function b(e,t,r,a,o,b){const p=Object(i["resolveComponent"])("EnrichedHeadline"),v=Object(i["resolveComponent"])("KPICardContainer"),h=Object(i["resolveComponent"])("SitesTable");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",s,[Object(i["createElementVNode"])("h1",n,[Object(i["createVNode"])(p,{"feature-name":e.translate("MultiSites_AllWebsitesDashboardTitle")},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MultiSites_AllWebsitesDashboardTitle")),1)]),_:1},8,["feature-name"])])]),Object(i["createVNode"])(v,{"is-loading":e.isLoadingKPIs,"model-value":e.kpis},null,8,["is-loading","model-value"]),Object(i["createElementVNode"])("div",l,[Object(i["createElementVNode"])("div",c,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"text",onKeydown:t[0]||(t[0]=Object(i["withKeys"])(t=>e.searchSite(e.searchTerm),["enter"])),"onUpdate:modelValue":t[1]||(t[1]=t=>e.searchTerm=t),placeholder:e.translate("Actions_SubmenuSitesearch")},null,40,u),[[i["vModelText"],e.searchTerm]]),Object(i["createElementVNode"])("span",{class:"icon-search",onClick:t[2]||(t[2]=t=>e.searchSite(e.searchTerm)),title:e.translate("General_ClickToSearch")},null,8,d)]),!e.isWidgetized&&e.isUserAllowedToAddSite?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,class:"btn",href:e.addSiteUrl},Object(i["toDisplayString"])(e.translate("SitesManager_AddSite")),9,m)):Object(i["createCommentVNode"])("",!0)]),Object(i["createVNode"])(h,{"display-revenue":e.displayRevenue,"display-sparklines":e.displaySparklines},null,8,["display-revenue","display-sparklines"])],64)}var p=r("19dc");function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */const h="desc",O="nb_visits";class g{constructor(){v(this,"fetchAbort",null),v(this,"privateState",Object(i["reactive"])({dashboardKPIs:{badges:{},evolutionPeriod:"day",hits:"?",hitsCompact:"?",hitsEvolution:"",hitsTrend:0,pageviews:"?",pageviewsCompact:"?",pageviewsEvolution:"",pageviewsTrend:0,revenue:"?",revenueCompact:"?",revenueEvolution:"",revenueTrend:0,visits:"?",visitsCompact:"?",visitsEvolution:"",visitsTrend:0},dashboardSites:[],errorLoading:!1,isLoadingKPIs:!1,isLoadingSites:!1,numSites:0,paginationCurrentPage:0,sortColumn:O,sortOrder:h})),v(this,"autoRefreshInterval",0),v(this,"autoRefreshTimeout",null),v(this,"pageSize",25),v(this,"searchTerm",""),v(this,"state",Object(i["computed"])(()=>Object(i["readonly"])(this.privateState))),v(this,"numberOfPages",Object(i["computed"])(()=>Math.ceil(this.state.value.numSites/this.pageSize-1))),v(this,"currentPagingOffset",Object(i["computed"])(()=>Math.ceil(this.state.value.paginationCurrentPage*this.pageSize))),v(this,"paginationLowerBound",Object(i["computed"])(()=>0===this.state.value.numSites?0:1+this.currentPagingOffset.value)),v(this,"paginationUpperBound",Object(i["computed"])(()=>{if(0===this.state.value.numSites)return 0;const e=this.pageSize+this.currentPagingOffset.value,t=this.state.value.numSites;return e<t?e:t}))}reloadDashboard(){this.privateState.sortColumn=O,this.privateState.sortOrder=h,this.privateState.paginationCurrentPage=0,this.refreshData()}navigateNextPage(){this.privateState.paginationCurrentPage!==this.numberOfPages.value&&(this.privateState.paginationCurrentPage+=1,this.refreshData(!0))}navigatePreviousPage(){0!==this.privateState.paginationCurrentPage&&(this.privateState.paginationCurrentPage-=1,this.refreshData(!0))}searchSite(e){this.searchTerm=e,this.privateState.paginationCurrentPage=0,this.refreshData(!0)}setAutoRefreshInterval(e){this.autoRefreshInterval=e}setPageSize(e){this.pageSize=e}sortBy(e){this.privateState.sortColumn===e?this.privateState.sortOrder="desc"===this.privateState.sortOrder?"asc":"desc":this.privateState.sortOrder="label"===e?"asc":"desc",this.privateState.sortColumn=e,this.refreshData(!0)}cancelAutoRefresh(){this.autoRefreshTimeout&&(clearTimeout(this.autoRefreshTimeout),this.autoRefreshTimeout=null)}refreshData(e=!1){this.fetchAbort&&(this.fetchAbort.abort(),this.fetchAbort=null,this.cancelAutoRefresh()),this.fetchAbort=new AbortController,this.privateState.errorLoading=!1,this.privateState.isLoadingKPIs=!e,this.privateState.isLoadingSites=!0;const t={method:"MultiSites.getAllWithGroups",filter_limit:this.pageSize,filter_offset:this.currentPagingOffset.value,filter_sort_column:this.privateState.sortColumn,filter_sort_order:this.privateState.sortOrder,format_metrics:0,showColumns:["hits_evolution","hits_evolution_trend","label","hits","nb_pageviews","nb_visits","pageviews_evolution","pageviews_evolution_trend","revenue","revenue_evolution","revenue_evolution_trend","visits_evolution","visits_evolution_trend"].join(",")};return this.searchTerm&&(t.pattern=this.searchTerm),p["AjaxHelper"].fetch(t,{abortController:this.fetchAbort}).then(t=>{e||(this.updateDashboardKPIs(t),p["Matomo"].postEvent("MultiSites.DashboardKPIs.updated",{parameters:(new p["AjaxHelper"]).mixinDefaultGetParams({filter_limit:this.pageSize,filter_offset:this.currentPagingOffset.value,filter_sort_column:this.privateState.sortColumn,filter_sort_order:this.privateState.sortOrder,pattern:this.searchTerm}),kpis:this.privateState.dashboardKPIs})),this.updateDashboardSites(t)}).catch(()=>{this.privateState.dashboardSites=[],this.privateState.errorLoading=!0}).finally(()=>{this.privateState.isLoadingKPIs=!1,this.privateState.isLoadingSites=!1,this.fetchAbort=null,this.startAutoRefresh()})}startAutoRefresh(){if(this.cancelAutoRefresh(),this.autoRefreshInterval<=0)return;let e;try{e=p["Periods"].parse(p["Matomo"].period,p["Matomo"].currentDateString)}catch(t){}e&&e.containsToday()&&(this.autoRefreshTimeout=setTimeout(()=>{this.autoRefreshTimeout=null,this.refreshData()},1e3*this.autoRefreshInterval))}updateDashboardKPIs(e){this.privateState.dashboardKPIs={badges:{hits:"",pageviews:"",revenue:"",visits:""},evolutionPeriod:p["Matomo"].period,hits:p["NumberFormatter"].formatNumber(e.totals.hits),hitsCompact:p["NumberFormatter"].formatNumberCompact(e.totals.hits),hitsEvolution:p["NumberFormatter"].calculateAndFormatEvolution(e.totals.hits,e.totals.previous_hits,!0),hitsTrend:Math.sign(e.totals.hits-e.totals.previous_hits),pageviews:p["NumberFormatter"].formatNumber(e.totals.nb_pageviews),pageviewsCompact:p["NumberFormatter"].formatNumberCompact(e.totals.nb_pageviews),pageviewsEvolution:p["NumberFormatter"].calculateAndFormatEvolution(e.totals.nb_pageviews,e.totals.previous_nb_pageviews,!0),pageviewsTrend:Math.sign(e.totals.nb_pageviews-e.totals.previous_nb_pageviews),revenue:p["NumberFormatter"].formatCurrency(e.totals.revenue,""),revenueCompact:p["NumberFormatter"].formatCurrencyCompact(e.totals.revenue,""),revenueEvolution:p["NumberFormatter"].calculateAndFormatEvolution(e.totals.revenue,e.totals.previous_revenue,!0),revenueTrend:Math.sign(e.totals.revenue-e.totals.previous_revenue),visits:p["NumberFormatter"].formatNumber(e.totals.nb_visits),visitsCompact:p["NumberFormatter"].formatNumberCompact(e.totals.nb_visits),visitsEvolution:p["NumberFormatter"].calculateAndFormatEvolution(e.totals.nb_visits,e.totals.previous_nb_visits,!0),visitsTrend:Math.sign(e.totals.nb_visits-e.totals.previous_nb_visits)}}updateDashboardSites(e){this.privateState.dashboardSites=e.sites,this.privateState.numSites=e.numSites}}var j=new g;const S={class:"kpiCardContainer"},f={key:0,class:"kpiCard kpiCardLoading"},k=Object(i["createElementVNode"])("div",{class:"kpiCardTitle"}," ",-1),C={class:"kpiCardValue"},_=Object(i["createElementVNode"])("div",{class:"kpiCardEvolution"},[Object(i["createElementVNode"])("span",{class:"kpiCardEvolutionTrend"}," ")],-1),N={key:0,class:"kpiCardBadge"};function y(e,t,r,a,o,s){const n=Object(i["resolveComponent"])("MatomoLoader"),l=Object(i["resolveComponent"])("KPICard");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",S,[e.isLoading?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",f,[k,Object(i["createElementVNode"])("div",C,[Object(i["createVNode"])(n)]),_,e.hasKpiBadge?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",N," ")):Object(i["createCommentVNode"])("",!0)])):(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],{key:1},Object(i["renderList"])(e.kpis,(t,r)=>(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:"kpi-card-"+r},[r>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,class:Object(i["normalizeClass"])({kpiCardDivider:!0,kpiCardDividerBadge:e.hasKpiBadge})}," ",2)):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(l,{"model-value":t},null,8,["model-value"])],64))),128))])}const E={class:"kpiCard"},V={class:"kpiCardTitle"},w=["title"],T={class:"kpiCardEvolution"},B={key:1,class:"kpiCardEvolution"},P=Object(i["createElementVNode"])("span",{class:"kpiCardEvolutionTrend"}," ",-1),M=[P],D=["innerHTML"];function x(e,t,r,a,o,s){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",E,[Object(i["createElementVNode"])("div",V,[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])("kpiCardIcon "+e.kpi.icon)},null,2),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate(e.kpi.title)),1)]),Object(i["createElementVNode"])("div",{class:"kpiCardValue",title:e.kpi.valueCompact!==e.kpi.value?e.kpi.value:""},Object(i["toDisplayString"])(e.kpi.valueCompact),9,w),Object(i["createElementVNode"])("div",T,[""!==e.kpi.evolutionValue?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])("kpiCardEvolutionTrend "+e.evolutionTrendClass)},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])("kpiCardEvolutionIcon "+e.evolutionTrendIcon)},null,2),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.kpi.evolutionValue),1)],2),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate(e.evolutionTrendFrom)),1)],64)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",B,M))]),e.kpi.badge?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,innerHTML:e.$sanitize(e.kpi.badge),class:"kpiCardBadge"},null,8,D)):Object(i["createCommentVNode"])("",!0)])}var L=Object(i["defineComponent"])({props:{modelValue:{type:Object,required:!0}},computed:{evolutionTrendFrom(){switch(this.kpi.evolutionPeriod){case"day":return"MultiSites_EvolutionFromPreviousDay";case"week":return"MultiSites_EvolutionFromPreviousWeek";case"month":return"MultiSites_EvolutionFromPreviousMonth";case"year":return"MultiSites_EvolutionFromPreviousYear";default:return"MultiSites_EvolutionFromPreviousPeriod"}},evolutionTrendClass(){return 1===this.kpi.evolutionTrend?"kpiTrendPositive":-1===this.kpi.evolutionTrend?"kpiTrendNegative":"kpiTrendNeutral"},evolutionTrendIcon(){return 1===this.kpi.evolutionTrend?"icon-chevron-up":-1===this.kpi.evolutionTrend?"icon-chevron-down":"icon-circle"},kpi(){return this.modelValue}}});L.render=x;var A=L,F=Object(i["defineComponent"])({components:{MatomoLoader:p["MatomoLoader"],KPICard:A},props:{isLoading:Boolean,modelValue:{type:Array,required:!0}},computed:{hasKpiBadge(){return this.kpis.some(e=>!!e.badge)},kpis(){return this.modelValue}}});F.render=y;var G=F;const R={class:"sitesTableContainer"},I={class:"card-table dataTable sitesTable"},z={class:"sitesTableEvolutionSelector"},U=["value"],H={value:"hits_evolution"},$={value:"visits_evolution"},q={value:"pageviews_evolution"},K={key:0,value:"revenue_evolution"},W={key:0},J={class:"sitesTableLoading",colspan:"7"},Y={key:1},Q={colspan:"7"},X={class:"notification system notification-error"},Z=Object(i["createElementVNode"])("br",null,null,-1),ee=Object(i["createElementVNode"])("br",null,null,-1),te=["href"],re=["href"],ae=["href"],oe={key:0,class:"sitesTablePagination"},ie={class:"dataTablePages"};function se(e,t,r,a,o,s){const n=Object(i["resolveComponent"])("MatomoLoader"),l=Object(i["resolveComponent"])("SitesTableSite");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createElementVNode"])("div",R,[Object(i["createElementVNode"])("table",I,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",{onClick:t[0]||(t[0]=t=>e.sortBy("label")),class:"label"},[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_Website"))+" ",1),"label"===e.sortColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("th",{onClick:t[1]||(t[1]=t=>e.sortBy("nb_visits"))},["nb_visits"===e.sortColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_ColumnNbVisits")),1)]),Object(i["createElementVNode"])("th",{onClick:t[2]||(t[2]=t=>e.sortBy("nb_pageviews"))},["nb_pageviews"===e.sortColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_ColumnPageviews")),1)]),Object(i["createElementVNode"])("th",{onClick:t[3]||(t[3]=t=>e.sortBy("hits"))},["hits"===e.sortColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_ColumnHits")),1)]),e.displayRevenue?(Object(i["openBlock"])(),Object(i["createElementBlock"])("th",{key:0,onClick:t[4]||(t[4]=t=>e.sortBy("revenue"))},["revenue"===e.sortColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_ColumnRevenue")),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("th",{onClick:t[5]||(t[5]=t=>e.sortBy(e.evolutionSelector))},[e.sortColumn===e.evolutionSelector?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,class:Object(i["normalizeClass"])(e.sortColumnClass)},null,2)):Object(i["createCommentVNode"])("",!0),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("MultiSites_Evolution")),1)]),Object(i["createElementVNode"])("th",z,[Object(i["createElementVNode"])("select",{class:"browser-default",value:e.evolutionSelector,onChange:t[6]||(t[6]=t=>e.changeEvolutionSelector(t.target.value))},[Object(i["createElementVNode"])("option",H,Object(i["toDisplayString"])(e.translate("General_ColumnHits")),1),Object(i["createElementVNode"])("option",$,Object(i["toDisplayString"])(e.translate("General_ColumnNbVisits")),1),Object(i["createElementVNode"])("option",q,Object(i["toDisplayString"])(e.translate("General_ColumnPageviews")),1),e.displayRevenue?(Object(i["openBlock"])(),Object(i["createElementBlock"])("option",K,Object(i["toDisplayString"])(e.translate("General_ColumnRevenue")),1)):Object(i["createCommentVNode"])("",!0)],40,U)])])]),Object(i["createElementVNode"])("tbody",null,[e.isLoading?(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",W,[Object(i["createElementVNode"])("td",J,[Object(i["createVNode"])(n)])])):e.errorLoading?(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",Y,[Object(i["createElementVNode"])("td",Q,[Object(i["createElementVNode"])("div",X,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_ErrorRequest","",""))+" ",1),Z,ee,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_NeedMoreHelp"))+" ",1),Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.externalRawLink("https://matomo.org/faq/troubleshooting/faq_19489/")},Object(i["toDisplayString"])(e.translate("General_Faq")),9,te),Object(i["createTextVNode"])(" – "),Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.externalRawLink("https://forum.matomo.org/")},Object(i["toDisplayString"])(e.translate("Feedback_CommunityHelp")),9,re),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null," – ",512),[[i["vShow"],e.errorShowProfessionalHelp]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.externalRawLink("https://matomo.org/support-plans/")},Object(i["toDisplayString"])(e.translate("Feedback_ProfessionalHelp")),9,ae),[[i["vShow"],e.errorShowProfessionalHelp]]),Object(i["createTextVNode"])(". ")])])])):(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],{key:2},Object(i["renderList"])(e.sites,t=>(Object(i["openBlock"])(),Object(i["createBlock"])(l,{"display-revenue":e.displayRevenue,"evolution-metric":e.evolutionMetric,key:"site-"+t.idsite,"model-value":t,"display-sparkline":e.displaySparklines,"sparkline-metric":e.sparklineMetric},null,8,["display-revenue","evolution-metric","model-value","display-sparkline","sparkline-metric"]))),128))])])]),!e.isLoading||e.paginationUpperBound>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",oe,[Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"dataTablePrevious",onClick:t[7]||(t[7]=t=>e.navigatePreviousPage())}," « "+Object(i["toDisplayString"])(e.translate("General_Previous")),513),[[i["vShow"],0!==e.paginationCurrentPage]]),Object(i["createElementVNode"])("span",ie,Object(i["toDisplayString"])(e.translate("General_Pagination",e.paginationLowerBound,e.paginationUpperBound,e.numberOfFilteredSites)),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"dataTableNext",onClick:t[8]||(t[8]=t=>e.navigateNextPage())},Object(i["toDisplayString"])(e.translate("General_Next"))+" » ",513),[[i["vShow"],e.paginationCurrentPage<e.paginationMaxPage]])])):Object(i["createCommentVNode"])("",!0)],64)}const ne={class:"label"},le=["href","title"],ce=Object(i["createElementVNode"])("span",{class:"icon icon-outlink"},null,-1),ue=[ce],de=["href"],me={key:1,class:"value"},be={class:"value"},pe={class:"value"},ve={class:"value"},he={key:0},Oe={class:"value"},ge=["colspan"],je=["src"],Se={key:1,class:"sitesTableSparkline"},fe=["href","title"],ke=["src"];function Ce(e,t,r,a,o,s){return Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{class:Object(i["normalizeClass"])({sitesTableGroup:!!e.site.isGroup,sitesTableGroupSite:!e.site.isGroup&&!!e.site.group,sitesTableSite:!e.site.isGroup&&!e.site.group})},[Object(i["createElementVNode"])("td",ne,[e.site.isGroup?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",me,Object(i["toDisplayString"])(e.siteLabel),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.site.main_url,title:e.translate("General_GoTo",e.site.main_url)},ue,8,le),Object(i["createElementVNode"])("a",{title:"View reports",class:"value",href:e.dashboardUrl},Object(i["toDisplayString"])(e.siteLabel),9,de)],64))]),Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("span",be,Object(i["toDisplayString"])(e.formatNumber(e.site.nb_visits)),1)]),Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("span",pe,Object(i["toDisplayString"])(e.formatNumber(e.site.nb_pageviews)),1)]),Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("span",ve,Object(i["toDisplayString"])(e.formatNumber(e.site.hits)),1)]),e.displayRevenue?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",he,[Object(i["createElementVNode"])("span",Oe,Object(i["toDisplayString"])(e.formatCurrency(e.site.revenue,e.site.currencySymbol||"")),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("td",{colspan:e.displaySparkline?1:2},[!e.site.isGroup&&e.sparklineMetric in e.site?(Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],{key:0},[Object(i["createElementVNode"])("img",{src:e.evolutionIconSrc,alt:""},null,8,je),Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(e.evolutionTrendClass)},Object(i["toDisplayString"])(e.calculateAndFormatEvolution(e.site[e.sparklineMetric],e.site["previous_"+e.sparklineMetric]*e.site.ratio,!0)),3)],64)):Object(i["createCommentVNode"])("",!0)],8,ge),e.displaySparkline?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",Se,[e.site.isGroup?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,rel:"noreferrer noopener",target:"_blank",href:e.dashboardUrl,title:e.translate("General_GoTo",e.translate("Dashboard_DashboardOf",e.siteLabel))},[Object(i["createElementVNode"])("img",{alt:"",width:"100",height:"25",src:e.evolutionSparklineSrc},null,8,ke)],8,fe))])):Object(i["createCommentVNode"])("",!0)],2)}var _e=Object(i["defineComponent"])({props:{displayRevenue:{type:Boolean,required:!0},evolutionMetric:{type:String,required:!0},modelValue:{type:Object,required:!0},sparklineMetric:String,displaySparkline:Boolean},computed:{dashboardUrl(){const e=p["MatomoUrl"].stringify({module:"CoreHome",action:"index",date:p["Matomo"].currentDateString,period:p["Matomo"].period,idSite:this.site.idsite});return`?${e}${this.tokenParam}`},evolutionIconSrc(){return 1===this.evolutionTrend?"plugins/MultiSites/images/arrow_up.png":-1===this.evolutionTrend?"plugins/MultiSites/images/arrow_down.png":"plugins/MultiSites/images/stop.png"},evolutionSparklineSrc(){let e=p["Matomo"].currentDateString;if("range"!==p["Matomo"].period){const{startDate:t,endDate:r}=p["Range"].getLastNRange(p["Matomo"].period,"30",p["Matomo"].currentDateString);e=`${Object(p["format"])(t)},${Object(p["format"])(r)}`}const t=p["MatomoUrl"].stringify({module:"MultiSites",action:"getEvolutionGraph",date:e,period:p["Matomo"].period,idSite:this.site.idsite,columns:this.sparklineMetric,evolutionBy:this.sparklineMetric,colors:JSON.stringify(p["Matomo"].getSparklineColors()),viewDataTable:"sparkline"});return`?${t}${this.tokenParam}`},evolutionTrend(){const e=this.evolutionMetric+"_trend";return this.site[e]},evolutionTrendClass(){return 1===this.evolutionTrend?"evolutionTrendPositive":-1===this.evolutionTrend?"evolutionTrendNegative":""},site(){return this.modelValue},siteLabel(){return p["Matomo"].helper.htmlDecode(this.site.label)},tokenParam(){const e=p["MatomoUrl"].urlParsed.value.token_auth;return e?"&token_auth="+e:""}}});_e.render=Ce;var Ne=_e,ye=Object(i["defineComponent"])({components:{MatomoLoader:p["MatomoLoader"],SitesTableSite:Ne},props:{displayRevenue:{type:Boolean,required:!0},displaySparklines:{type:Boolean,required:!0}},data(){return{evolutionSelector:"visits_evolution"}},computed:{errorLoading(){return j.state.value.errorLoading},errorShowProfessionalHelp(){return p["Matomo"].config&&p["Matomo"].config.are_ads_enabled},evolutionMetric(){return this.evolutionSelector},isLoading(){return j.state.value.isLoadingSites},numberOfFilteredSites(){return j.state.value.numSites},paginationCurrentPage(){return j.state.value.paginationCurrentPage},paginationLowerBound(){return j.paginationLowerBound.value},paginationUpperBound(){return j.paginationUpperBound.value},paginationMaxPage(){return j.numberOfPages.value},sites(){return j.state.value.dashboardSites},sortColumn(){return j.state.value.sortColumn},sortColumnClass(){return{sitesTableSort:!0,sitesTableSortAsc:"asc"===this.sortOrder,sitesTableSortDesc:"desc"===this.sortOrder}},sortOrder(){return j.state.value.sortOrder},sparklineMetric(){switch(this.evolutionMetric){case"hits_evolution":return"hits";case"pageviews_evolution":return"nb_pageviews";case"revenue_evolution":return"revenue";case"visits_evolution":return"nb_visits";default:return""}}},methods:{changeEvolutionSelector(e){this.evolutionSelector=e,this.sortBy(e)},navigateNextPage(){j.navigateNextPage()},navigatePreviousPage(){j.navigatePreviousPage()},sortBy(e){j.sortBy(e)}}});ye.render=se;var Ee=ye,Ve=Object(i["defineComponent"])({components:{EnrichedHeadline:p["EnrichedHeadline"],KPICardContainer:G,SitesTable:Ee},props:{autoRefreshInterval:{type:Number,required:!0},displayRevenue:{type:Boolean,required:!0},displaySparklines:{type:Boolean,required:!0},isWidgetized:{type:Boolean,required:!0},pageSize:{type:Number,required:!0}},data(){return{searchTerm:""}},mounted(){Object(i["watch"])(()=>p["MatomoUrl"].hashParsed.value,()=>j.reloadDashboard()),j.setAutoRefreshInterval(this.autoRefreshInterval),j.setPageSize(this.pageSize),j.reloadDashboard()},computed:{addSiteUrl(){return"?"+p["MatomoUrl"].stringify(Object.assign(Object.assign(Object.assign({},p["MatomoUrl"].urlParsed.value),p["MatomoUrl"].hashParsed.value),{},{module:"SitesManager",action:"index",showaddsite:"1"}))},isLoadingKPIs(){return j.state.value.isLoadingKPIs},kpis(){var e,t,r;const{dashboardKPIs:a}=j.state.value,o=[{badge:(null===(e=a.badges)||void 0===e?void 0:e.visits)||"",icon:"icon-user",title:"MultiSites_TotalVisits",value:a.visits,valueCompact:a.visitsCompact,evolutionPeriod:a.evolutionPeriod,evolutionTrend:a.visitsTrend,evolutionValue:a.visitsEvolution},{badge:(null===(t=a.badges)||void 0===t?void 0:t.pageviews)||"",icon:"icon-show",title:"MultiSites_TotalPageviews",value:a.pageviews,valueCompact:a.pageviewsCompact,evolutionPeriod:a.evolutionPeriod,evolutionTrend:a.pageviewsTrend,evolutionValue:a.pageviewsEvolution},{badge:(null===(r=a.badges)||void 0===r?void 0:r.hits)||"",icon:"icon-hits",title:"MultiSites_TotalHits",value:a.hits,valueCompact:a.hitsCompact,evolutionPeriod:a.evolutionPeriod,evolutionTrend:a.hitsTrend,evolutionValue:a.hitsEvolution}];var i;this.displayRevenue&&o.push({badge:(null===(i=a.badges)||void 0===i?void 0:i.revenue)||"",icon:"icon-dollar-sign",title:"General_TotalRevenue",value:a.revenue,valueCompact:a.revenueCompact,evolutionPeriod:a.evolutionPeriod,evolutionTrend:a.revenueTrend,evolutionValue:a.revenueEvolution});return o},isUserAllowedToAddSite(){return p["Matomo"].hasSuperUserAccess}},methods:{searchSite(e){j.searchSite(e)}}});Ve.render=b;var we=Ve;const Te={key:0,class:"multisites-label label"},Be=["href"],Pe={key:0},Me=["href","title"],De=Object(i["createElementVNode"])("span",{class:"icon icon-outlink"},null,-1),xe=[De],Le={key:1,class:"multisites-label label"},Ae={class:"value"},Fe={class:"multisites-column"},Ge={class:"value"},Re={class:"multisites-column"},Ie={class:"value"},ze={class:"multisites-column"},Ue={class:"value"},He={key:2,class:"multisites-column"},$e={class:"value"},qe=["title"],Ke={key:0,class:"visits value"},We=Object(i["createElementVNode"])("img",{class:"multisites_icon",src:"plugins/MultiSites/images/arrow_up.png",alt:""},null,-1),Je={style:{color:"green"}},Ye=Object(i["createElementVNode"])("img",{class:"multisites_icon",src:"plugins/MultiSites/images/stop.png",alt:""},null,-1),Qe=Object(i["createElementVNode"])("img",{class:"multisites_icon",src:"plugins/MultiSites/images/arrow_down.png",alt:""},null,-1),Xe={style:{color:"red"}},Ze={key:4,style:{width:"180px"}},et={key:0,class:"sparkline",style:{width:"100px",margin:"auto"}},tt=["href","title"],rt=["src"];function at(e,t,r,a,o,s){return Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{class:Object(i["normalizeClass"])({groupedWebsite:e.website.group,website:!e.website.group,group:e.website.isGroup}),ref:"root"},[e.website.isGroup?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",Te,[Object(i["createElementVNode"])("a",{title:"View reports",class:"value truncated-text-line",href:e.dashboardUrl(e.website)},Object(i["toDisplayString"])(e.websiteLabel),9,Be),e.website.main_url?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Pe,[Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.website.main_url,title:e.translate("General_GoTo",e.website.main_url)},xe,8,Me)])):Object(i["createCommentVNode"])("",!0)])),e.website.isGroup?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",Le,[Object(i["createElementVNode"])("span",Ae,Object(i["toDisplayString"])(e.websiteLabel),1)])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("td",Fe,[Object(i["createElementVNode"])("span",Ge,Object(i["toDisplayString"])(e.website.nb_visits),1)]),Object(i["createElementVNode"])("td",Re,[Object(i["createElementVNode"])("span",Ie,Object(i["toDisplayString"])(e.website.nb_pageviews),1)]),Object(i["createElementVNode"])("td",ze,[Object(i["createElementVNode"])("span",Ue,Object(i["toDisplayString"])(e.website.hits),1)]),e.displayRevenueColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",He,[Object(i["createElementVNode"])("span",$e,Object(i["toDisplayString"])(e.website.revenue),1)])):Object(i["createCommentVNode"])("",!0),"range"!==e.period?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",{key:3,class:"multisites-evolution",title:e.website.tooltip},[e.website.isGroup?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ke,[Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null,[We,Object(i["createTextVNode"])(),Object(i["createElementVNode"])("span",Je,Object(i["toDisplayString"])(e.website[e.evolutionMetric]),1)],512),[[i["vShow"],1===e.website[e.evolutionMetric+"_trend"]]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null,[Ye,Object(i["createTextVNode"])(),Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.website[e.evolutionMetric]),1)],512),[[i["vShow"],0===e.website[e.evolutionMetric+"_trend"]]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null,[Qe,Object(i["createTextVNode"])(),Object(i["createElementVNode"])("span",Xe,Object(i["toDisplayString"])(e.website[e.evolutionMetric]),1)],512),[[i["vShow"],-1===e.website[e.evolutionMetric+"_trend"]]])]))],8,qe)):Object(i["createCommentVNode"])("",!0),e.showSparklines?(Object(i["openBlock"])(),Object(i["createElementBlock"])("td",Ze,[e.website.isGroup?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",et,[Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.dashboardUrl(e.website),title:e.translate("General_GoTo",e.translate("Dashboard_DashboardOf",e.websiteLabel))},[Object(i["createElementVNode"])("img",{alt:"",width:"100",height:"25",src:e.sparklineImage(e.website)},null,8,rt)],8,tt)]))])):Object(i["createCommentVNode"])("",!0)],2)}var ot=Object(i["defineComponent"])({props:{website:{type:Object,required:!0},evolutionMetric:{type:String,required:!0},showSparklines:Boolean,dateSparkline:String,displayRevenueColumn:Boolean,metric:String},mounted(){p["Matomo"].postEvent("MultiSites.MultiSitesSite.mounted",{element:this.$refs.root})},unmounted(){p["Matomo"].postEvent("MultiSites.MultiSitesSite.unmounted",{element:this.$refs.root})},methods:{dashboardUrl(e){return`index.php?module=CoreHome&action=index&date=${this.date}&period=${this.period}&idSite=${e.idsite}${this.tokenParam}`},sparklineImage(e){let{metric:t}=this;switch(this.evolutionMetric){case"visits_evolution":t="nb_visits";break;case"pageviews_evolution":t="nb_pageviews";break;case"hits_evolution":t="hits";break;case"revenue_evolution":t="revenue";break;default:break}return`index.php?module=MultiSites&action=getEvolutionGraph&period=${this.period}&date=${this.dateSparkline}&evolutionBy=${t}&columns=${t}&idSite=${e.idsite}&idsite=${e.idsite}&viewDataTable=sparkline${this.tokenParam}&colors=`+encodeURIComponent(JSON.stringify(p["Matomo"].getSparklineColors()))}},computed:{tokenParam(){const e=p["MatomoUrl"].urlParsed.value.token_auth;return e?"&token_auth="+e:""},period(){return p["Matomo"].period},date(){return p["MatomoUrl"].urlParsed.value.date},websiteLabel(){return p["Matomo"].helper.htmlDecode(this.website.label)}}});ot.render=at;var it=ot;function st(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */class nt{constructor(){st(this,"privateState",Object(i["reactive"])({sites:[],isLoading:!1,pageSize:25,currentPage:0,totalVisits:"?",totalPageviews:"?",totalHits:"?",totalActions:"?",totalRevenue:"?",searchTerm:"",lastVisits:"?",lastVisitsDate:"?",numberOfSites:0,loadingMessage:Object(p["translate"])("MultiSites_LoadingWebsites"),reverse:!0,sortColumn:"nb_visits",refreshInterval:0,errorLoadingSites:!1})),st(this,"refreshTimeout",null),st(this,"fetchAbort",null),st(this,"state",Object(i["computed"])(()=>Object(i["readonly"])(this.privateState))),st(this,"numberOfFilteredSites",Object(i["computed"])(()=>this.state.value.numberOfSites)),st(this,"numberOfPages",Object(i["computed"])(()=>Math.ceil(this.numberOfFilteredSites.value/this.state.value.pageSize-1))),st(this,"currentPagingOffset",Object(i["computed"])(()=>Math.ceil(this.state.value.currentPage*this.state.value.pageSize))),st(this,"paginationLowerBound",Object(i["computed"])(()=>this.currentPagingOffset.value+1)),st(this,"paginationUpperBound",Object(i["computed"])(()=>{let e=this.currentPagingOffset.value+this.state.value.pageSize;const t=this.numberOfFilteredSites.value;return e>t&&(e=t),e}))}cancelRefereshInterval(){this.refreshTimeout&&(clearTimeout(this.refreshTimeout),this.refreshTimeout=null)}updateWebsitesList(e){if(!e)return void this.onError();const t=e.sites;t.forEach(e=>{if(1!==e.ratio&&"1"!==e.ratio){const t=p["NumberFormatter"].formatPercent(Math.round(100*parseInt(e.ratio,10)));let r=null,a="0",o="0",i="0",s="0";if("nb_visits"!==this.state.value.sortColumn&&"visits_evolution"!==this.state.value.sortColumn||(a=p["NumberFormatter"].formatNumber(e.previous_nb_visits),o=p["NumberFormatter"].formatNumber(e.nb_visits),i=p["NumberFormatter"].formatPercent(e.visits_evolution),r=Object(p["translate"])("General_ColumnNbVisits"),s=p["NumberFormatter"].formatNumber(Math.round(parseInt(e.previous_nb_visits,10)*parseInt(e.ratio,10)))),"pageviews_evolution"===this.state.value.sortColumn&&(a=""+e.previous_nb_pageviews,o=""+e.nb_pageviews,i=p["NumberFormatter"].formatPercent(e.pageviews_evolution),r=Object(p["translate"])("General_ColumnPageviews"),s=p["NumberFormatter"].formatNumber(Math.round(parseInt(e.previous_nb_pageviews,10)*parseInt(e.ratio,10)))),"hits_evolution"===this.state.value.sortColumn&&(a=""+e.previous_hits,o=""+e.hits,i=p["NumberFormatter"].formatPercent(e.hits_evolution),r=Object(p["translate"])("General_ColumnHits"),s=p["NumberFormatter"].formatNumber(Math.round(parseInt(e.previous_hits,10)*parseInt(e.ratio,10)))),"revenue_evolution"===this.state.value.sortColumn&&(a=p["NumberFormatter"].formatCurrency(e.previous_revenue,e.currencySymbol),o=p["NumberFormatter"].formatCurrency(e.revenue,e.currencySymbol),i=p["NumberFormatter"].formatPercent(e.revenue_evolution),r=Object(p["translate"])("General_ColumnRevenue"),s=p["NumberFormatter"].formatCurrency(Math.round(parseInt(e.previous_revenue,10)*parseInt(e.ratio,10)),e.currencySymbol)),r)switch(e.tooltip=Object(p["translate"])("MultiSites_EvolutionComparisonIncomplete",[t])+"\n",e.tooltip+=Object(p["translate"])("MultiSites_EvolutionComparisonProportional",[t,""+s,r,""+a])+"\n",e.periodName){case"day":e.tooltip+=Object(p["translate"])("MultiSites_EvolutionComparisonDay",[""+o,r,""+s,e.previousRange,""+i]);break;case"week":e.tooltip+=Object(p["translate"])("MultiSites_EvolutionComparisonWeek",[""+o,r,""+s,e.previousRange,""+i]);break;case"month":e.tooltip+=Object(p["translate"])("MultiSites_EvolutionComparisonMonth",[""+o,r,""+s,e.previousRange,""+i]);break;case"year":e.tooltip+=Object(p["translate"])("MultiSites_EvolutionComparisonYear",[""+o,r,""+s,e.previousRange,""+i]);break;default:break}}}),this.privateState.totalVisits=e.totals.nb_visits,this.privateState.totalPageviews=e.totals.nb_pageviews,this.privateState.totalHits=e.totals.hits,this.privateState.totalActions=e.totals.nb_actions,this.privateState.totalRevenue=e.totals.revenue,this.privateState.lastVisits=e.totals.previous_nb_visits,this.privateState.sites=t,this.privateState.numberOfSites=e.numSites,this.privateState.lastVisitsDate=e.lastDate}sortBy(e){this.state.value.sortColumn===e&&(this.privateState.reverse=!this.state.value.reverse),this.privateState.sortColumn=e,this.fetchAllSites()}previousPage(){this.privateState.currentPage=this.state.value.currentPage-1,this.fetchAllSites()}nextPage(){this.privateState.currentPage=this.state.value.currentPage+1,this.fetchAllSites()}searchSite(e){this.privateState.searchTerm=e,this.privateState.currentPage=0,this.fetchAllSites()}fetchAllSites(){this.fetchAbort&&(this.fetchAbort.abort(),this.fetchAbort=null,this.cancelRefereshInterval()),this.privateState.isLoading=!0,this.privateState.errorLoadingSites=!1;const e={method:"MultiSites.getAllWithGroups",hideMetricsDoc:"1",filter_sort_order:"asc",filter_limit:this.state.value.pageSize,filter_offset:this.currentPagingOffset.value,showColumns:["label","nb_visits","nb_pageviews","hits","visits_evolution","visits_evolution_trend","pageviews_evolution","pageviews_evolution_trend","hits_evolution","hits_evolution_trend","revenue_evolution","revenue_evolution_trend","nb_actions","revenue"].join(",")};return this.privateState.searchTerm&&(e.pattern=this.privateState.searchTerm),this.privateState.sortColumn&&(e.filter_sort_column=this.privateState.sortColumn),this.privateState.reverse&&(e.filter_sort_order="desc"),this.fetchAbort=new AbortController,p["AjaxHelper"].fetch(e,{abortController:this.fetchAbort}).then(e=>{this.updateWebsitesList(e)}).catch(()=>{this.onError()}).finally(()=>{this.privateState.isLoading=!1,this.fetchAbort=null,this.state.value.refreshInterval&&this.state.value.refreshInterval>0&&(this.cancelRefereshInterval(),this.refreshTimeout=setTimeout(()=>{this.refreshTimeout=null,this.fetchAllSites()},1e3*this.state.value.refreshInterval))})}onError(){this.privateState.errorLoadingSites=!0,this.privateState.sites=[]}setRefreshInterval(e){this.privateState.refreshInterval=e}setPageSize(e){this.privateState.pageSize=e}}var lt=new nt;const ct={ref:"root"},ut={class:"card-title"},dt=["innerHTML","title"],mt={id:"mt",class:"dataTable card-table",cellspacing:"0"},bt={class:"heading"},pt={class:"heading"},vt={class:"heading"},ht={class:"heading"},Ot={class:"heading"},gt=["colspan"],jt=["value"],St={value:"visits_evolution"},ft={value:"pageviews_evolution"},kt={value:"hits_evolution"},Ct={key:0,value:"revenue_evolution"},_t={key:0},Nt={colspan:"7",class:"allWebsitesLoading"},yt={key:1},Et={key:0},Vt={colspan:"7"},wt={class:"notification system notification-error"},Tt=Object(i["createElementVNode"])("br",null,null,-1),Bt=Object(i["createElementVNode"])("br",null,null,-1),Pt=["href"],Mt=["href"],Dt=["href"],xt={colspan:"8",class:"paging"},Lt={class:"row"},At={class:"col s3 add_new_site"},Ft=["href"],Gt=Object(i["createElementVNode"])("span",{class:"icon-add"},null,-1),Rt={class:"col s6"},It={style:{cursor:"pointer"}},zt={class:"dataTablePages"},Ut={id:"counter"},Ht={style:{cursor:"pointer"},class:"pointer"},$t=Object(i["createElementVNode"])("div",{class:"col s3"}," ",-1),qt={row_id:"last"},Kt={colspan:"8",class:"site_search"},Wt={class:"row"},Jt={class:"input-field col s12"},Yt=["placeholder"],Qt=["title"];function Xt(e,t,r,a,o,s){const n=Object(i["resolveComponent"])("EnrichedHeadline"),l=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("MultisitesSite");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ct,[Object(i["createElementVNode"])("h2",ut,[Object(i["createVNode"])(n,{"help-url":e.externalRawLink("https://matomo.org/faq/new-to-piwik/all-websites-dashboard/"),"feature-name":e.translate("General_AllWebsitesDashboard")},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_AllWebsitesDashboard"))+" ",1),Object(i["createElementVNode"])("span",{class:"smallTitle",innerHTML:e.$sanitize(this.smallTitleContent),title:e.smallTitleTooltip},null,8,dt)]),_:1},8,["help-url","feature-name"])]),Object(i["createElementVNode"])("table",mt,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",{id:"names",class:Object(i["normalizeClass"])(["label",{columnSorted:"label"===e.sortColumn}]),onClick:t[0]||(t[0]=t=>e.sortBy("label"))},[Object(i["createElementVNode"])("span",bt,Object(i["toDisplayString"])(e.translate("General_Website")),1),Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&"label"===e.sortColumn,multisites_desc:e.reverse&&"label"===e.sortColumn}]),style:{"margin-left":"3.5px"}},null,2)],2),Object(i["createElementVNode"])("th",{id:"visits",class:Object(i["normalizeClass"])(["multisites-column",{columnSorted:"nb_visits"===e.sortColumn}]),onClick:t[1]||(t[1]=t=>e.sortBy("nb_visits"))},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&"nb_visits"===e.sortColumn,multisites_desc:e.reverse&&"nb_visits"===e.sortColumn}]),style:{"margin-right":"3.5px"}},null,2),Object(i["createElementVNode"])("span",pt,Object(i["toDisplayString"])(e.translate("General_ColumnNbVisits")),1)],2),Object(i["createElementVNode"])("th",{id:"pageviews",class:Object(i["normalizeClass"])(["multisites-column",{columnSorted:"nb_pageviews"===e.sortColumn}]),onClick:t[2]||(t[2]=t=>e.sortBy("nb_pageviews"))},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&"nb_pageviews"===e.sortColumn,multisites_desc:e.reverse&&"nb_pageviews"===e.sortColumn}]),style:{"margin-right":"3.5px"}},null,2),Object(i["createElementVNode"])("span",vt,Object(i["toDisplayString"])(e.translate("General_ColumnPageviews")),1)],2),Object(i["createElementVNode"])("th",{id:"hits",class:Object(i["normalizeClass"])(["multisites-column",{columnSorted:"hits"===e.sortColumn}]),onClick:t[3]||(t[3]=t=>e.sortBy("hits"))},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&"hits"===e.sortColumn,multisites_desc:e.reverse&&"hits"===e.sortColumn}]),style:{"margin-right":"3.5px"}},null,2),Object(i["createElementVNode"])("span",ht,Object(i["toDisplayString"])(e.translate("General_ColumnHits")),1)],2),e.displayRevenueColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("th",{key:0,id:"revenue",class:Object(i["normalizeClass"])(["multisites-column",{columnSorted:"revenue"===e.sortColumn}]),onClick:t[4]||(t[4]=t=>e.sortBy("revenue"))},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&"revenue"===e.sortColumn,multisites_desc:e.reverse&&"revenue"===e.sortColumn}]),style:{"margin-right":"3.5px"}},null,2),Object(i["createElementVNode"])("span",Ot,Object(i["toDisplayString"])(e.translate("General_ColumnRevenue")),1)],2)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("th",{id:"evolution",class:Object(i["normalizeClass"])({columnSorted:e.evolutionSelector===e.sortColumn}),colspan:e.showSparklines?2:1},[Object(i["createElementVNode"])("span",{class:Object(i["normalizeClass"])(["arrow",{multisites_asc:!e.reverse&&e.evolutionSelector===e.sortColumn,multisites_desc:e.reverse&&e.evolutionSelector===e.sortColumn}]),style:{"margin-right":"3.5px"}},null,2),Object(i["createElementVNode"])("span",{class:"evolution",onClick:t[5]||(t[5]=t=>e.sortBy(e.evolutionSelector)),style:{"margin-right":"3.5px"}},Object(i["toDisplayString"])(e.translate("MultiSites_Evolution")),1),Object(i["createElementVNode"])("select",{class:"selector browser-default",id:"evolution_selector",value:e.evolutionSelector,onChange:t[6]||(t[6]=t=>{e.evolutionSelector=t.target.value,e.sortBy(e.evolutionSelector)})},[Object(i["createElementVNode"])("option",St,Object(i["toDisplayString"])(e.translate("General_ColumnNbVisits")),1),Object(i["createElementVNode"])("option",ft,Object(i["toDisplayString"])(e.translate("General_ColumnPageviews")),1),Object(i["createElementVNode"])("option",kt,Object(i["toDisplayString"])(e.translate("General_ColumnHits")),1),e.displayRevenueColumn?(Object(i["openBlock"])(),Object(i["createElementBlock"])("option",Ct,Object(i["toDisplayString"])(e.translate("General_ColumnRevenue")),1)):Object(i["createCommentVNode"])("",!0)],40,jt)],10,gt)])]),e.isLoading?(Object(i["openBlock"])(),Object(i["createElementBlock"])("tbody",_t,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",Nt,[Object(i["createVNode"])(l,{"loading-message":e.loadingMessage,loading:e.isLoading},null,8,["loading-message","loading"])])])])):Object(i["createCommentVNode"])("",!0),e.isLoading?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("tbody",yt,[e.errorLoadingSites?(Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",Et,[Object(i["createElementVNode"])("td",Vt,[Object(i["createElementVNode"])("div",wt,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("General_ErrorRequest","",""))+" ",1),Tt,Bt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("General_NeedMoreHelp"))+" ",1),Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.externalRawLink("https://matomo.org/faq/troubleshooting/faq_19489/")},Object(i["toDisplayString"])(e.translate("General_Faq")),9,Pt),Object(i["createTextVNode"])(" – "),Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.externalRawLink("https://forum.matomo.org/")},Object(i["toDisplayString"])(e.translate("Feedback_CommunityHelp")),9,Mt),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",null," – ",512),[[i["vShow"],e.areAdsForProfessionalServicesEnabled]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{rel:"noreferrer noopener",target:"_blank",href:e.professionalHelpUrl},Object(i["toDisplayString"])(e.translate("Feedback_ProfessionalHelp")),9,Dt),[[i["vShow"],e.areAdsForProfessionalServicesEnabled]]),Object(i["createTextVNode"])(". ")])])])):Object(i["createCommentVNode"])("",!0),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.sites,t=>(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:t.idsite,website:t,"evolution-metric":e.evolutionSelector,"date-sparkline":e.dateSparkline,"show-sparklines":e.showSparklines,metric:e.sortColumn,"display-revenue-column":e.displayRevenueColumn},null,8,["website","evolution-metric","date-sparkline","show-sparklines","metric","display-revenue-column"]))),128))])),Object(i["createElementVNode"])("tfoot",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",xt,[Object(i["createElementVNode"])("div",Lt,[Object(i["createElementVNode"])("div",At,[e.hasSuperUserAccess?(Object(i["openBlock"])(),Object(i["createElementBlock"])("a",{key:0,href:e.addSiteUrl},[Gt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("SitesManager_AddSite")),1)],8,Ft)):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",Rt,[Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{id:"prev",class:"previous dataTablePrevious",onClick:t[7]||(t[7]=t=>e.previousPage())},[Object(i["createElementVNode"])("span",It,"« "+Object(i["toDisplayString"])(e.translate("General_Previous")),1)],512),[[i["vShow"],!(0===e.currentPage)]]),Object(i["createElementVNode"])("span",zt,[Object(i["createElementVNode"])("span",Ut,Object(i["toDisplayString"])(e.translate("General_Pagination",e.paginationLowerBound,e.paginationUpperBound,e.numberOfFilteredSites)),1)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{id:"next",class:"next dataTableNext",onClick:t[8]||(t[8]=t=>e.nextPage())},[Object(i["createElementVNode"])("span",Ht,Object(i["toDisplayString"])(e.translate("General_Next"))+" »",1)],512),[[i["vShow"],!(e.currentPage>=e.numberOfPages)]])]),$t])])]),Object(i["createElementVNode"])("tr",qt,[Object(i["createElementVNode"])("td",Kt,[Object(i["createElementVNode"])("div",Wt,[Object(i["createElementVNode"])("div",Jt,[Object(i["withDirectives"])(Object(i["createElementVNode"])("input",{type:"text",onKeydown:t[9]||(t[9]=Object(i["withKeys"])(t=>e.searchSite(e.searchTerm),["enter"])),"onUpdate:modelValue":t[10]||(t[10]=t=>e.searchTerm=t),placeholder:e.translate("Actions_SubmenuSitesearch")},null,40,Yt),[[i["vModelText"],e.searchTerm]]),Object(i["createElementVNode"])("span",{class:"icon-search search_ico",onClick:t[11]||(t[11]=t=>e.searchSite(e.searchTerm)),title:e.translate("General_ClickToSearch")},null,8,Qt)])])])])])])],512)}var Zt=Object(i["defineComponent"])({props:{displayRevenueColumn:Boolean,showSparklines:Boolean,dateSparkline:String,pageSize:Number,autoRefreshTodayReport:Number},components:{EnrichedHeadline:p["EnrichedHeadline"],ActivityIndicator:p["ActivityIndicator"],MultisitesSite:it},data(){return{evolutionSelector:"visits_evolution",searchTerm:""}},created(){this.pageSize&&lt.setPageSize(this.pageSize),this.refresh(this.autoRefreshTodayReport)},methods:{refresh(e){lt.setRefreshInterval(e),lt.fetchAllSites()},sortBy(e){lt.sortBy(e)},previousPage(){lt.previousPage()},nextPage(){lt.nextPage()},searchSite(){lt.searchSite(this.searchTerm)}},computed:{hasSuperUserAccess(){return p["Matomo"].hasSuperUserAccess},date(){return p["MatomoUrl"].urlParsed.value.date},idSite(){return p["MatomoUrl"].urlParsed.value.idSite},url(){return p["Matomo"].piwik_url},period(){return p["Matomo"].period},areAdsForProfessionalServicesEnabled(){return p["Matomo"].config&&p["Matomo"].config.are_ads_enabled},sortColumn(){return lt.state.value.sortColumn},reverse(){return lt.state.value.reverse},smallTitleContent(){const e=lt.state.value;return Object(p["translate"])("General_TotalVisitsPageviewsActionsRevenue",`<strong>${e.totalVisits}</strong>`,`<strong>${e.totalPageviews}</strong>`,`<strong>${e.totalActions}</strong>`,`<strong>${e.totalRevenue}</strong>`)},smallTitleTooltip(){const e=lt.state.value;return Object(p["translate"])("General_EvolutionSummaryGeneric",Object(p["translate"])("General_NVisits",""+e.totalVisits),this.date,""+e.lastVisits,e.lastVisitsDate,p["NumberFormatter"].calculateAndFormatEvolution(p["NumberFormatter"].parseFormattedNumber(e.totalVisits),p["NumberFormatter"].parseFormattedNumber(e.lastVisits)))},loadingMessage(){return lt.state.value.loadingMessage},isLoading(){return lt.state.value.isLoading},errorLoadingSites(){return lt.state.value.errorLoadingSites},sites(){return lt.state.value.sites},numberOfPages(){return lt.numberOfPages.value},currentPage(){return lt.state.value.currentPage},paginationLowerBound(){return lt.paginationLowerBound.value},paginationUpperBound(){return lt.paginationUpperBound.value},numberOfFilteredSites(){return lt.numberOfFilteredSites.value},professionalHelpUrl(){return Object(p["externalRawLink"])("https://matomo.org/support-plans/")},addSiteUrl(){return`index.php?module=SitesManager&action=index&showaddsite=1&period=${this.period}&date=${this.date}&idSite=${this.idSite}`}}});Zt.render=Xt;var er=Zt;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link    https://matomo.org
 * @license https://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# sourceMappingURL=MultiSites.umd.min.js.map